<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Causal Frameworks – Political Science &amp; Political Economy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="mathjax-config.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./quant4.html">4 Causal Frameworks</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Kevin’s PSPE Resources</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./games.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guide to Game Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Essential Mathematics</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
 <span class="menu-text">Quantitative Methods (Causal Inference)</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quant1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 Introductory Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quant2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 Multiple Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quant3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Classical Least Squares Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quant4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">4 Causal Frameworks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quant5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5 Randomised Controlled Trials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quant6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6 Selection on Observables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quant7.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7 Instrumental Variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quant8.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8 Regression Discontinuity</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quant9.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9 Differences-in-Differences</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
 <span class="menu-text">More Statistical Models</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model1.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model2.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression for Counts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Forecasting and Prediction Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unsupervised Learning Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model6.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Trait Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model7.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Class Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model8.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structural Equation Models</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On This Page</h2>
   
  <ul>
  <li><a href="#potential-outcomes-framework" id="toc-potential-outcomes-framework" class="nav-link active" data-scroll-target="#potential-outcomes-framework"><strong>Potential Outcomes Framework</strong></a>
  <ul class="collapse">
  <li><a href="#treatment-variable" id="toc-treatment-variable" class="nav-link" data-scroll-target="#treatment-variable">Treatment Variable</a></li>
  <li><a href="#potential-outcomes" id="toc-potential-outcomes" class="nav-link" data-scroll-target="#potential-outcomes">Potential Outcomes</a></li>
  <li><a href="#observed-outcomes-and-missing-data" id="toc-observed-outcomes-and-missing-data" class="nav-link" data-scroll-target="#observed-outcomes-and-missing-data">Observed Outcomes and “Missing Data”</a></li>
  <li><a href="#stable-unit-treatment-value-assumption" id="toc-stable-unit-treatment-value-assumption" class="nav-link" data-scroll-target="#stable-unit-treatment-value-assumption">Stable Unit Treatment Value Assumption</a></li>
  </ul></li>
  <li><a href="#causal-estimands" id="toc-causal-estimands" class="nav-link" data-scroll-target="#causal-estimands"><strong>Causal Estimands</strong></a>
  <ul class="collapse">
  <li><a href="#individual-treatment-effect" id="toc-individual-treatment-effect" class="nav-link" data-scroll-target="#individual-treatment-effect">Individual Treatment Effect</a></li>
  <li><a href="#average-treatment-effect-ate" id="toc-average-treatment-effect-ate" class="nav-link" data-scroll-target="#average-treatment-effect-ate">Average Treatment Effect (ATE)</a></li>
  <li><a href="#average-treatment-effect-on-the-treated-att" id="toc-average-treatment-effect-on-the-treated-att" class="nav-link" data-scroll-target="#average-treatment-effect-on-the-treated-att">Average Treatment Effect on the Treated (ATT)</a></li>
  <li><a href="#conditional-average-treatment-effect-cate" id="toc-conditional-average-treatment-effect-cate" class="nav-link" data-scroll-target="#conditional-average-treatment-effect-cate">Conditional Average Treatment Effect (CATE)</a></li>
  </ul></li>
  <li><a href="#selection-bias-and-confounders" id="toc-selection-bias-and-confounders" class="nav-link" data-scroll-target="#selection-bias-and-confounders"><strong>Selection Bias and Confounders</strong></a>
  <ul class="collapse">
  <li><a href="#naive-estimator-and-selection-bias" id="toc-naive-estimator-and-selection-bias" class="nav-link" data-scroll-target="#naive-estimator-and-selection-bias">Naive Estimator and Selection Bias</a></li>
  <li><a href="#confounders" id="toc-confounders" class="nav-link" data-scroll-target="#confounders">Confounders</a></li>
  <li><a href="#assignment-mechanism" id="toc-assignment-mechanism" class="nav-link" data-scroll-target="#assignment-mechanism">Assignment Mechanism</a></li>
  </ul></li>
  <li><a href="#directed-acyclic-graphs" id="toc-directed-acyclic-graphs" class="nav-link" data-scroll-target="#directed-acyclic-graphs"><strong>Directed Acyclic Graphs</strong></a>
  <ul class="collapse">
  <li><a href="#components-of-the-graphs" id="toc-components-of-the-graphs" class="nav-link" data-scroll-target="#components-of-the-graphs">Components of the Graphs</a></li>
  <li><a href="#representing-interventions" id="toc-representing-interventions" class="nav-link" data-scroll-target="#representing-interventions">Representing Interventions</a></li>
  <li><a href="#blocked-paths" id="toc-blocked-paths" class="nav-link" data-scroll-target="#blocked-paths">Blocked Paths</a></li>
  </ul></li>
  <li><a href="#implementation-in-r" id="toc-implementation-in-r" class="nav-link" data-scroll-target="#implementation-in-r"><strong>Implementation in R</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Causal Frameworks</h1>
<p class="subtitle lead">Chapter 4, Quantitative Methods (Causal Inference)</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In the past few chapters, we have focused on correlations.</p>
<p>This chapter introduces the main <strong>causal</strong> frameworks (potential outcomes, causal graphs), the main causal estimands used in causal inference, and the idea of selection bias and confounders. This chapter is the foundation in which the next set of methods for causal inference will be built on.</p>
<p>Use the right sidebar for quick navigation. R-code for causal diagrams is provided at the bottom.</p>
<hr>
<section id="potential-outcomes-framework" class="level1">
<h1><strong>Potential Outcomes Framework</strong></h1>
<section id="treatment-variable" class="level3">
<h3 class="anchored" data-anchor-id="treatment-variable">Treatment Variable</h3>
<p>In causal inference, we are interested in how treatment <span class="math inline">\(D\)</span> causes outcome variable <span class="math inline">\(Y\)</span>.</p>
<p><span class="math inline">\(D\)</span> is our treatment variable. The indicator of treatment for each unit <span class="math inline">\(i\)</span> is <span class="math inline">\(D_i\)</span>.</p>
<p><span class="math display">\[
D_i = \begin{cases}
1 \quad \text{if unit } i \text{ recieved the treatment} \\
0 \quad \text{if unit } i \text{ did not recieve the treatment}
\end{cases}
\]</span></p>
<p>Causal variables/treatments must occur before the outcome. A variable cannot cause something to occur in the past.</p>
<p>Causal variables/treatments must be able to be manipulated (in order to imagine a world where the treatment did not occur). For example, <span class="math inline">\(D\)</span> cannot be sex assigned at birth, ethnicity, etc. For example, major global events (how did 9/11 cause the Arab spring?)</p>
<p><br></p>
</section>
<section id="potential-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="potential-outcomes">Potential Outcomes</h3>
<p>Imagine there are two hypothetical parallel worlds - one where unit <span class="math inline">\(i\)</span> receives the treatment <span class="math inline">\(D\)</span>, and one where unit <span class="math inline">\(i\)</span> does not receive the treatment <span class="math inline">\(D\)</span>. Everything else in these worlds is identical.</p>
<p><strong>Potential Outcomes</strong> for unit <span class="math inline">\(i\)</span> are denoted:</p>
<p><span class="math display">\[
Y_{di}, Y_i(d) =\begin{cases}
&amp; Y_{1i}, \ Y_i(1) \quad \text{Outcome for unit } i \text{ when } D_i = 1 \\
&amp; Y_{0i}, \ Y_i(0) \quad \text{Outcome for unit } i \text{ when } D_i = 0 \\
\end{cases}
\]</span></p>
<p>For example, imagine we are interested in finding the effect of democracy <span class="math inline">\(D\)</span> on GDP growth <span class="math inline">\(Y\)</span>. Potential outcome <span class="math inline">\(Y_{1i}\)</span> is the potential GDP growth of country <span class="math inline">\(i\)</span> if they were a democracy, and outcome <span class="math inline">\(Y_{0i}\)</span> is the potential GDP growth of a country <span class="math inline">\(i\)</span> if they were not a democracy.</p>
<p>Note that these are hypothetical worlds - we will obviously not observe both of them at the same time. The next section discusses this.</p>
<p><br></p>
</section>
<section id="observed-outcomes-and-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="observed-outcomes-and-missing-data">Observed Outcomes and “Missing Data”</h3>
<p>Of course, there is not two parallel worlds with 2 potential outcomes. In the real world, each unit <span class="math inline">\(i\)</span> either receives treatment <span class="math inline">\(D\)</span>, or does not. We do not observe the other potential outcome.</p>
<p><span class="math inline">\(Y_i\)</span> is the observed outcome for unit <span class="math inline">\(i\)</span>. This is given by formula:</p>
<p><span class="math display">\[
Y_i = D_i \cdot Y_{1i} + (1-D_i) \cdot Y_{0i}
\]</span></p>
<p>If we plug in <span class="math inline">\(D_i = 0, 1\)</span> to the equation above, we get the observed outcomes:</p>
<p><span class="math display">\[
Y_i = \begin{cases}
Y_{1i} \quad \text{if } D_i = 1 \\
Y_{0i} \quad \text{if } D_i = 0 \\
\end{cases}
\]</span></p>
<p>Before the treatment (<em>A priori</em>), both potential outcomes could be observed. After the treatment, one is <strong>observed</strong>, and the other is <strong>counterfactual</strong>. For any given experiment, only one will ever be seen, and the counterfactual will never be seen (missing data problem).</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Neyman Urn Model
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Potential Outcomes can be visualised with the Neyman Urn Model.</p>
<p>Before the treatment, we have a box (we cannot see) with both potential outcomes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-802589608.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:55.0%"></p>
</figure>
</div>
<p>Then, when we apply treatment, we stick our hand into the box that we cannot see, and pull out one observed outcome.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-2975134148.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>We are essentially sampling from potential outcomes to get observed outcomes.</p>
</div>
</div>
</div>
<p>This missing data problem is called the <strong>fundamental problem of causal inference</strong>.</p>
<p><br></p>
</section>
<section id="stable-unit-treatment-value-assumption" class="level3">
<h3 class="anchored" data-anchor-id="stable-unit-treatment-value-assumption">Stable Unit Treatment Value Assumption</h3>
<p>The above given observed and potential outcome frameworks depends on the Stable Unit Treatment Value Assumption (SUTVA).</p>
<p><span class="math display">\[
\begin{align}
Y_{(D_1, D_2, \dots, D_N)i} &amp; = Y_{(D_1', D_2', \dots, D_N')i} \\
Y_{di} \text{ under current randomisation} &amp; = Y_{di} \text{ under all other randomisations}
\end{align}
\]</span></p>
<p>Or more intuitively, the potential outcomes of unit <span class="math inline">\(i\)</span> only depends on their own treatment status, and no other unit’s treatment status. Thus, changing everyone else’s treatment status has no effects on unit <span class="math inline">\(i\)</span>’s potential outcomes <span class="math inline">\(Y_{di}\)</span>. The treatment is also the same for everyone (treatment is stable and consistent)</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples of SUTVA Violations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>Spill-over effects: If we are testing a new curriculum, one student <span class="math inline">\(j\)</span> getting the new curriculum may teach their friend <span class="math inline">\(i\)</span> the new curriculum, thus affecting the potential outcomes of <span class="math inline">\(i\)</span>.</p></li>
<li><p>Contagion: If we are studying a disease, diseases can spread, so another unit <span class="math inline">\(j\)</span> getting a disease affects the potential outcomes of unit <span class="math inline">\(i\)</span>.</p></li>
<li><p>Dilution: If we are studying vaccines - there is herd immunity - other people getting the vaccine also reduces our chances of getting the disease.</p></li>
<li><p>Variable levels of treatment: If we are doing a drug trial, if some people got two doses, while others only got one dose. This is not a consistent treatment.</p></li>
<li><p>Technical errors: If someone who is supposed to be treated accidentally is not treated. This is not a consistent treatment.</p></li>
</ul>
</div>
</div>
</div>
<p>When SUTVA is violated, potential outcomes become very messy, and we no longer have the neat framework as before.</p>
<p><br></p>
<p><br></p>
<hr>
</section>
</section>
<section id="causal-estimands" class="level1">
<h1><strong>Causal Estimands</strong></h1>
<section id="individual-treatment-effect" class="level3">
<h3 class="anchored" data-anchor-id="individual-treatment-effect">Individual Treatment Effect</h3>
<p>Remember the potential outcomes from parallel worlds <span class="math inline">\(Y_{1i}\)</span> and <span class="math inline">\(Y_{0i}\)</span>.</p>
<p>Since these two parallel worlds are identical except for the fact one receives the treatment <span class="math inline">\(D\)</span> and the other does not, the causal effect of <span class="math inline">\(D\)</span> should be the difference between the potential outcomes of these two worlds. Thus, the individual treatment effect of a unit <span class="math inline">\(i\)</span> is:</p>
<p><span class="math display">\[
\tau_i = Y_{1i} - Y_{0i}
\]</span></p>
<p>This is the specific treatment effect for a specific unit <span class="math inline">\(i\)</span>. This cannot be observed, because we do not see both potential outcomes for the same unit <span class="math inline">\(i\)</span>.</p>
<p>This is also very hard to estimate, as we cannot reliably fill in the missing potential outcome for any one unit <span class="math inline">\(i\)</span>. Thus, we almost never use individual treatment effects, and use group treatment effects.</p>
<p><br></p>
</section>
<section id="average-treatment-effect-ate" class="level3">
<h3 class="anchored" data-anchor-id="average-treatment-effect-ate">Average Treatment Effect (ATE)</h3>
<p>ATE is a group-level causal estimand.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Group-Level Causal Estimands
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Consider a population of units <span class="math inline">\(i = 1, \dots, N\)</span>.</p>
<p>The population has potential outcomes represented in two (only partially observed) vectors:</p>
<p><span class="math display">\[
\begin{split}
&amp; Y_1 = (Y_{11}, Y_{12}, \dots, Y_{1N}) \\
&amp; Y_0 = (Y_{01}, Y_{02}, \dots, Y_{0N})
\end{split}
\]</span></p>
<p>We compare these two vectors of potential outcomes. The most common way to do this is to use their expected values.</p>
</div>
</div>
</div>
<p>The Average Treatment Effect is defined as:</p>
<p><span class="math display">\[
\begin{split}
\tau_{ATE} &amp; = E(Y_{1i} - Y_{0i}) \\
&amp; = \underbrace{\frac{1}{N} \sum\limits_{i=1}^N (Y_{1i} - Y_{0i})}_{\text{a formula for average}}
\end{split}
\]</span></p>
<p>We cannot calculate this with observed data - since we need all potential outcomes to do this. We can estimate this (covered throughout this course).</p>
<p><br></p>
</section>
<section id="average-treatment-effect-on-the-treated-att" class="level3">
<h3 class="anchored" data-anchor-id="average-treatment-effect-on-the-treated-att">Average Treatment Effect on the Treated (ATT)</h3>
<p>An alternative estimand to the ATE is the <strong>Average Treatment Effect on the Treated (ATT)</strong>:</p>
<p><span class="math display">\[
\begin{split}
\tau_{ATT} &amp; = E(Y_{1i} - Y_{0i} \ | \ D_i = 1) \\
&amp; = \underbrace{\frac{1}{N_1} \sum\limits_{i=1}^N D_i (Y_{1i} - Y_{0i}) \quad  \text{where } N_1 = \sum\limits_{i=1}^ND_i}_{\text{a formula for the average only for treated units}}
\end{split}
\]</span></p>
<p>This is the causal effect of <u>only units who have received the treatment</u>. Note that frequently the ATT is not equal to the ATE, so be aware of which estimand you are trying to estimate/identify.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ATT vs.&nbsp;ATE
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When does <span class="math inline">\(\tau_{ATT} = \tau_{ATE}\)</span>?</p>
<ul>
<li>When the expectation of the potential outcomes of both the treated and control are the same, then the two equal each other.</li>
</ul>
<p>The opposite is also true: if the expectation of the potential outcomes of both the treated and control are different, then the two are not equal.</p>
</div>
</div>
</div>
<p>The opposite estimand is the <strong>Average Treatment effect on the Untreated (ATU)</strong>, which only measures the causal effect of units who did not recieve the treatment.</p>
<p>This is not used very often, since it is kind of uninituive to think about treatment effects on individuals who did not recieve treatment. However, it can be useful in understanding identification assumptions.</p>
<p><br></p>
</section>
<section id="conditional-average-treatment-effect-cate" class="level3">
<h3 class="anchored" data-anchor-id="conditional-average-treatment-effect-cate">Conditional Average Treatment Effect (CATE)</h3>
<p>The conditional average treatment effect is any treatment effect where there is a condition on a characteristic/covariate:</p>
<p><span class="math display">\[
\tau_{CATE}(x) = E(Y_{1i} - Y_{0i} \ | \ \underbrace{X_i = x)}_{\text{condition}}
\]</span></p>
<p>This is the causal effect of only variables who meet the condition of the covariate specified. For example, you could find the conditional average treatment effect of only women (so the covariate which we are conditioning on is <em>gender</em>). You can also condition on multiple covariates.</p>
<p>This is often used for tailoring products/medicine/advertising to certain groups of people. It is also frequently used in identification strategies.</p>
<p>This estimand will go by other names, including the <strong>Local Average Treatment Effect (LATE)</strong>.</p>
<p><br></p>
<p><br></p>
<hr>
</section>
</section>
<section id="selection-bias-and-confounders" class="level1">
<h1><strong>Selection Bias and Confounders</strong></h1>
<section id="naive-estimator-and-selection-bias" class="level3">
<h3 class="anchored" data-anchor-id="naive-estimator-and-selection-bias">Naive Estimator and Selection Bias</h3>
<p>A natural way to estimate the ATE is to use a naive estimator: find the average difference of <u><strong>observed</strong></u> outcomes. This is called the naive estimator:</p>
<p><span class="math display">\[
\hat\tau_{naive} = \underbrace{E(Y_i|D_i = 1)}_{\text{for treated}} - \underbrace{E(Y_i|D_i = 0)}_{\text{for control}}
\]</span></p>
<p>However, there is an issue - we can show this with algebra:</p>
<p><span class="math display">\[
\begin{align}
\hat\tau_{naive} &amp; = E(Y_i|D_i = 1) - E(Y_i|D_i = 0) \\
&amp; = \underbrace{E(Y_{1i}|D_i = 1) - E(Y_{0i} | D_i = 0)}_{\because \text{ observed potential outcomes}} \\
&amp; = E(Y_{1i}|D_i = 1) - E(Y_{0i} | D_i = 0) + \underbrace{E(Y_{0i}|D_i = 1) \color{red}{- E(Y_{0i}|D_i = 1)}}_{\because \text{ this equals 0, so we can add it}} \\
&amp; = \underbrace{E(Y_{1i}|D_i = 1) \color{red}{- E(Y_{0i}|D_i = 1)}}_{\tau_{ATT}} + \underbrace{E(Y_{0i}|D_i = 1) - E(Y_{0i} | D_i = 0)}_{\text{Selection Bias}} \\
\end{align}
\]</span></p>
<p>We can see that our naive estimator produces the <span class="math inline">\(\tau_{ATT}\)</span> <strong>plus</strong> an extra bit (called the selection bias). Thus, our naive estimator is <a href="./quant1.html#finite-sample-properties-of-estimators">biased</a>, so we should be careful about using this naive estimator (correlation does not equal causation).</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Naive Estimator Biased for ATU
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The proof above shows how the naive estimator is a biased estimator for the <span class="math inline">\(\tau_{ATT}\)</span>. We can also prove it is a biased estimator of the ATU:</p>
<p><span class="math display">\[
\begin{split}
\hat\tau_{naive} &amp; = E(Y_i|D_i = 1) - E(Y_i|D_i = 0) \\
&amp; = \underbrace{E(Y_{1i}|D_i = 1) - E(Y_{0i} | D_i = 0)}_{\because \text{ observed potential outcomes}} \\
&amp; = E(Y_{1i}|D_i = 1) - E(Y_{0i} | D_i = 0) + \underbrace{E(Y_{1i}|D_i = 0) - E(Y_{1i}|D_i = 0)}_{\because \text{ this equals 0, so we can add it}} \\
&amp; = \underbrace{E(Y_{1i}|D_i = 0)- E(Y_{0i}|D_i = 0)}_{\tau_{ATU}} + \underbrace{E(Y_{1i}|D_i = 1) - E(Y_{1i} | D_i = 0)}_{\text{Selection Bias}} \\
\end{split}
\]</span></p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Naive Estimator Biased for ATE
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The proofs above shows how the naive estimator is a biased estimator for the <span class="math inline">\(\tau_{ATT}\)</span> and <span class="math inline">\(\tau_{ATU}\)</span>. We can also prove it is a biased estimator of the ATE.</p>
<p>Let us first start with the ATE. Let us call <span class="math inline">\(Y_{1i} - Y_{0i} := \tau_i\)</span> for notation simplicity:</p>
<p><span class="math display">\[
\begin{align}
\tau_{ATE} &amp; = E(Y_{1i} - Y_{0i})  = E(\tau_i)\\
&amp; = \underbrace{E(\tau_i|D_i = 1)Pr(D_i = 1) + E(\tau_i|D_i = 0)Pr(D_i = 0)}_{\because \text{ weighted average of ATE and ATU by proportion}} \\
&amp; = E(\tau_i|D_i = 1) \underbrace{(1 -Pr(D_i = 0))}_{\because \text{ complement prob.}} + E(\tau_i|D_i = 0)Pr(D_i = 0) \\
\end{align}
\]</span></p>
<p>Let us call <span class="math inline">\(Pr(D_i = 0) := \pi\)</span> for notation simplicity. Now, continue:</p>
<p><span class="math display">\[
\begin{split}
&amp; = \underbrace{E(\Delta|D_i = 1) - \pi E(\Delta|D_i = 1)}_{\because \text{ distribute out}} + E(\tau_i|D_i = 0)\pi \\
&amp; = E(\tau_i|D_i = 1) + \underbrace{\pi[E(\tau_i|D_i = 0) - E(\tau_i|D_i = 1)]}_{\because \ \pi \text{ factored out }} \\
&amp; = E(Y_{1i} |D_i = 1) - E(Y_{0i}|D_i = 1) + \pi[E(\tau_i|D_i = 0) - E(\tau_i|D_i = 1)] \\
\end{split}
\]</span></p>
<p>Let us call the part <span class="math inline">\(\pi[E(\tau_i|D_i = 0) - E(\tau_i|D_i = 1)] := \Pi(\tau_i)\)</span>. Now, continue to simplify:</p>
<p><span class="math display">\[
\begin{split}
&amp; = E(Y_{1i} |D_i = 1) - E(Y_{0i}|D_i = 1) + \Pi(\tau_i) + \underbrace{E(Y_{1i} |D_i = 0) - E(Y_{0i}|D_i = 0)}_{\because \text{ these two cancel out so we add 0}}  \\
&amp; = E(Y_{1i} |D_i = 1) - E(Y_{0i}|D_i = 0) + E(Y_{1i} |D_i = 0)- E(Y_{0i}|D_i = 1) + \Pi(\tau_i) \\
&amp; = \underbrace{E(Y_i|D_i = 1)}_{\because \text{ observed outcome}} - \underbrace{E(Y_i|D_i = 0)}_{\because \text{ observed outcome}} + E(Y_{1i} |D_i = 0)- E(Y_{0i}|D_i = 1) + \Pi(\tau_i) \\
&amp; = \underbrace{E(Y_{i} |D_i = 1) - E(Y_{i}|D_i = 0)}_{\hat\tau_{naive}} + E(Y_{1i} |D_i = 0)- E(Y_{0i}|D_i = 1) + \Pi(\tau_i) \\
&amp; = \hat\tau_{naive}+ E(Y_{1i} |D_i = 0)- E(Y_{0i}|D_i = 1) + \Pi(\tau_i)
\end{split}
\]</span></p>
<p>Thus, we can see that <span class="math inline">\(\tau_{ATE}\)</span> is not equivalent to <span class="math inline">\(\hat\tau_{naive}\)</span>. Let us isolate <span class="math inline">\(\hat\tau_{naive}\)</span> to identify the selection bias.</p>
<p><span class="math display">\[
\begin{split}
&amp; \tau_{ATE} = \hat\tau_{naive}+ E(Y_{1i} |D_i = 0)- E(Y_{0i}|D_i = 1) + \Pi(\tau_i) \\
&amp; -\hat\tau_{naive} = -\tau{ATE} + E(Y_{1i} |D_i = 0)- E(Y_{0i}|D_i = 1) + \Pi(\tau_i) \\
&amp; \hat\tau_{naive} = \tau_{ATE} - E(Y_{1i} |D_i = 0) + E(Y_{0i}|D_i = 1) + \Pi(\tau_i) \\
&amp; \hat\tau_{naive} = \tau_{ATE} + \underbrace{E(Y_{0i}|D_i = 1)- E(Y_{1i} |D_i = 0) + \Pi(\tau_i)}_{\text{selection bias}}
\end{split}
\]</span></p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="confounders" class="level3">
<h3 class="anchored" data-anchor-id="confounders">Confounders</h3>
<p>Take the selection bias formula from above:</p>
<p><span class="math display">\[
\underbrace{E(Y_{0i}|D_i = 1)}_{Y_{0i}\text{ (treated)}} - \underbrace{E(Y_{0i} | D_i = 0)}_{Y_{0i}\text{ (control)}}
\]</span></p>
<p>If selection bias is non-zero, this essentially states that the expected potential outcome before treatment <span class="math inline">\(Y_{0i}\)</span> between the treatment and control groups is not equal.</p>
<p>Or in other words, the treatment and control groups have some other variable causing differences even before treatment has begun. This implies that the differences between the treatment and control group may not be due to treatment <span class="math inline">\(D\)</span>, but due to the underlying differences before treatment even occurred.</p>
<p><strong>Confounders</strong> are variables that cause the differences between treatment and control groups before the treatment has started. <u><strong>Confounders correlate with both the treatment variable and the outcome</strong></u>. If a variable only correlates with <span class="math inline">\(D\)</span> or <span class="math inline">\(Y\)</span>, then it is not a confounder. If must correlate with both <span class="math inline">\(D\)</span> <strong>and</strong> <span class="math inline">\(Y\)</span>.</p>
<p>This is why correlation does not equal causation - if the treatment and control group are different before we start the experiment, we cannot say the difference between the two is purely a result of treatment <span class="math inline">\(D\)</span>.</p>
<p>We can also think about confounders in terms of <a href="./quant3.html#omitted-variable-bias">omitted variable bias</a>. The formula for omitted variable bias is:</p>
<p><span class="math display">\[
E(\hat{\boldsymbol\beta}) = \boldsymbol\beta + \boldsymbol{\pi \delta}
\]</span></p>
<p>Where <span class="math inline">\(\boldsymbol\beta\)</span> are the true population parameters, <span class="math inline">\(\boldsymbol\pi\)</span> is the relationship between the confounder and treatment, and <span class="math inline">\(\boldsymbol\delta\)</span> is the relationship between confounder and outcome.</p>
<p>We can see that if either <span class="math inline">\(\boldsymbol\pi = 0\)</span> or <span class="math inline">\(\boldsymbol\delta = 0\)</span>, then there is 0 omitted variable bias - which implies that a confounder that causes bias must be correlated with both the treatment and outcome.</p>
<p><br></p>
</section>
<section id="assignment-mechanism" class="level3">
<h3 class="anchored" data-anchor-id="assignment-mechanism">Assignment Mechanism</h3>
<p>The Assignment Mechanism is the procedure that determines the treatment status of each unit. In causal inference, we want to restrict the assignment mechanism, in order to remove the effect of selection bias.</p>
<p>There are two types of studies that use different assignment mechanisms:</p>
<ol type="1">
<li>Randomisation Experiments: The assignment mechanism is both known, and controlled by the researcher. Generally, the researcher chooses some type of randomisation.</li>
<li>Observational Studies: The assignment mechanism is not known to, or not under the control of the researcher. This means that confounders may be driving selection into treatment and control, inducing bias.</li>
</ol>
<p>Generally, the most credible studies are randomisation studies, since we can control interventions to parse out the effect of confounders. Observational studies generally rely on more assumptions that need to be met, and need to be defended for the study to be credible.</p>
<p>In the next chapter, we will start off with Randomised Controlled Trials, which are a form of randomisation experiment. After that, we will start discusses observational studies, and what assumptions we need in these studies to identify the causal effect without selection bias.</p>
<p><br></p>
<p><br></p>
<hr>
</section>
</section>
<section id="directed-acyclic-graphs" class="level1">
<h1><strong>Directed Acyclic Graphs</strong></h1>
<section id="components-of-the-graphs" class="level3">
<h3 class="anchored" data-anchor-id="components-of-the-graphs">Components of the Graphs</h3>
<p>Causal Diagrams are a visual way to represent causal theories and frameworks, which allows us to visualise how variables interact with each other. Each Directed Acyclic Graph (DAG) has the following components:</p>
<ol type="1">
<li>Nodes: representing variables (which are also called vertices).</li>
<li>Directed Edges: Arrows that encode one-way causal theories between variables. For example, we might believe <span class="math inline">\(Z\)</span> causes <span class="math inline">\(X\)</span>, so we will draw an arrow from <span class="math inline">\(Z\)</span> to <span class="math inline">\(X\)</span>. These connections are <strong>observable</strong> (solid) or <strong>unobservable</strong> (dashed).</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-3648393347.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:35.0%"></p>
</figure>
</div>
<p>In the figure above, we have two unobserved variables: <span class="math inline">\(Q\)</span> and <span class="math inline">\(Y\)</span> We have three observed variables: <span class="math inline">\(Z\)</span>, <span class="math inline">\(D\)</span>, and <span class="math inline">\(Y\)</span>. We can see the causal theories represented by arrows.</p>
<p>We can see the causal effec <span class="math inline">\(Z \rightarrow Y\)</span> is confounded by <span class="math inline">\(W\)</span>: <span class="math inline">\(W\)</span> is affecting who gets treatment <span class="math inline">\(Z\)</span>, and causing <span class="math inline">\(Y\)</span>. Thus, <span class="math inline">\(W\)</span> is affecting who gets selected into treatment <span class="math inline">\(Z\)</span>, and selecting your potential outcome <span class="math inline">\(Y\)</span>. Thus, this is an example of selection bias. <span class="math inline">\(D \rightarrow Y\)</span> is confounded by <span class="math inline">\(Q\)</span>. <span class="math inline">\(Z \rightarrow D\)</span> is not confounded, so we can estimate this causal effect.</p>
<p><br></p>
</section>
<section id="representing-interventions" class="level3">
<h3 class="anchored" data-anchor-id="representing-interventions">Representing Interventions</h3>
<p>Treatments (interventions by the researcher, for example) are when we determine one variable exogenously (such as by randomisation). Or in other words, one variable is determined randomly externally, not caused by any variables within the directed acyclic graphs.</p>
<p>Treatments are represented by the <strong>do()</strong> operator. When the treatment is exogenous, we can break all the connections into that variable’s node. This is because we are determining the value of the variable, not any other variables.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-1438441757.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:35.0%"></p>
</figure>
</div>
<p>An intervention here is on variable <span class="math inline">\(D\)</span>. That means the value of <span class="math inline">\(D\)</span> is being chosen outside of this graph (by randomisation, or the researcher). This allows us to delete the arrow between <span class="math inline">\(Q \rightarrow D\)</span> and <span class="math inline">\(Z \rightarrow D\)</span>. This is because we are exogenously determining <span class="math inline">\(D\)</span>, so <span class="math inline">\(Q\)</span> and <span class="math inline">\(Z\)</span> are not determining the value of <span class="math inline">\(D\)</span>.</p>
<p>With exogenously determined variables, we can find the causal effect that variable is causing on another.</p>
<p><br></p>
</section>
<section id="blocked-paths" class="level3">
<h3 class="anchored" data-anchor-id="blocked-paths">Blocked Paths</h3>
<p>A set of nodes <span class="math inline">\(\{ \mathbf S \}\)</span> blocks a path <span class="math inline">\(p\)</span> if either:</p>
<ol type="1">
<li>If the path <span class="math inline">\(p\)</span> contains at least one arrow-emitting node included in the set of nodes <span class="math inline">\(S\)</span>, or</li>
<li>The path <span class="math inline">\(p\)</span> contains at least one collision node (multiple arrows point into it) that is outside the set of nodes <span class="math inline">\(S\)</span>, and the collision node has no descendant within the set of nodes <span class="math inline">\(S\)</span> (no arrows go out of it to another node).</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-2373065460.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
<p>Take this above causal diagram. We can see the following:</p>
<ol type="1">
<li>The path <span class="math inline">\(D \rightarrow P \rightarrow Y\)</span> is blocked by set <span class="math inline">\(\{P\}\)</span>, because node <span class="math inline">\(P\)</span> is one arrow-emitting node in the path <span class="math inline">\(D \rightarrow P \rightarrow Y\)</span>.</li>
<li>The path <span class="math inline">\(D \leftarrow M \rightarrow Y\)</span> is blocked by set <span class="math inline">\(\{M\}\)</span>, because node <span class="math inline">\(M\)</span> is one arrow-emitting node in the path <span class="math inline">\(D \leftarrow M \rightarrow Y\)</span>.</li>
<li><span class="math inline">\(D \leftarrow Z \rightarrow M \rightarrow Y\)</span> is blocked by <span class="math inline">\(\{M\}\)</span>, <span class="math inline">\(\{Z\}\)</span>, or <span class="math inline">\(\{M, Z\}\)</span>.</li>
</ol>
<p>Blocking paths is important, since in order to estimate <span class="math inline">\(D \rightarrow Y\)</span>, we need to block any other path between <span class="math inline">\(D\)</span> and <span class="math inline">\(Y\)</span> that is not directly <span class="math inline">\(D \rightarrow Y\)</span>.</p>
<p><br></p>
<p><br></p>
<hr>
</section>
</section>
<section id="implementation-in-r" class="level1">
<h1><strong>Implementation in R</strong></h1>
<p>This section will show how you can create DAGs in R. We will need the <em>ggdag</em> and <em>dagitty</em> packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Simple DAGs with Dagify
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You can create a very simple DAG with dagify as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dag_object <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  Y <span class="sc">~</span> X <span class="sc">+</span> D, <span class="co">#Y is caused by X and D</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  D <span class="sc">~</span> X <span class="co">#D is caused by X</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(dag_object) <span class="sc">+</span> <span class="fu">theme_dag</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This dag is not very customisable. This can be an issue if you want nodes to be in a specific location. See below for a more customisable DAG.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Custom DAGs with Dagitty
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You can create more complex DAGs with Dagitty. Dagitty allows us to position nodes in a coordinate system, which is useful in some purposes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dag_object <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="st">      D [pos = "0, 1"]</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">      Y [pos = "2, 1"]</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">      X [pos = "1, 2"]</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">      D -&gt; Y</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">      D &lt;- X -&gt; Y</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(dag_object) <span class="sc">+</span> <span class="fu">theme_dag</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <em>pos</em> arguments have the coordinates of where you want to put each node.</p>
<p>Below are the path connections, where you can use -&gt; and &lt;- to indicate relationships.</p>
</div>
</div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>