<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Kevin’s Political Science Handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preface" id="toc-preface" class="nav-link active" data-scroll-target="#preface">Preface</a></li>
  <li><a href="#section-0-essentials" id="toc-section-0-essentials" class="nav-link" data-scroll-target="#section-0-essentials">Section 0: Essentials</a></li>
  <li><a href="#section-1-core-statistical-methods" id="toc-section-1-core-statistical-methods" class="nav-link" data-scroll-target="#section-1-core-statistical-methods">Section 1: Core Statistical Methods</a></li>
  <li><a href="#section-2-formal-mathematical-models" id="toc-section-2-formal-mathematical-models" class="nav-link" data-scroll-target="#section-2-formal-mathematical-models">Section 2: Formal Mathematical Models</a></li>
  <li><a href="#section-3-modern-data-science-methods" id="toc-section-3-modern-data-science-methods" class="nav-link" data-scroll-target="#section-3-modern-data-science-methods">Section 3: Modern Data Science Methods</a></li>
  <li><a href="#section-4-advanced-statistical-methods" id="toc-section-4-advanced-statistical-methods" class="nav-link" data-scroll-target="#section-4-advanced-statistical-methods">Section 4: Advanced Statistical Methods</a></li>
  <li><a href="#appendix-topics-in-mathematics" id="toc-appendix-topics-in-mathematics" class="nav-link" data-scroll-target="#appendix-topics-in-mathematics">Appendix: Topics in Mathematics</a></li>
  <li><a href="#creator" id="toc-creator" class="nav-link" data-scroll-target="#creator">About the Author</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">Resources for Learning Statistics and R-Programming</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Kevin’s Political Science Handbook</h1>
<p class="subtitle lead">A Guide to Quantitative/Statistical Methods in the Social Sciences</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><br></p>
<p>This is a collection of materials and information on political science quantitative methods that I have compiled over my years of studying political science.</p>
<p>This handbook is best used on a laptop. Navigate to the different sections using the navigation bar on the left.</p>
<hr>
<section id="preface" class="level1">
<h1>Preface</h1>
<p>This handbook is a guide to Political Science, focusing on modern quantitative methodology and its applications to Political Science Research and other Social Sciences. This handbook is divided into sections, which are further subdivided into modules, which are further subdivided into chapters. The appendix contains notes on mathematics relevant to some of the methods. The sections do not have to be done in order, although it is recommended to start with sections 0 and 1, as they form the basis of much of what comes next.</p>
<p>Section 0 introduces basic mathematics and probability that is needed for the rest of the courses. Section 1 introduces the core statistical methods covered in a typical master’s degree or rigorous undergraduate degree. Section 2 introduces formal mathematical modelling and its applications to Political Science and Political Economy. Section 3 introduces modern data science methods that are increasingly popular in the discipline. Section 4 discusses advanced statistical concepts which are typically only covered in rigorous quantitative postgraduate degrees.</p>
<p>In terms of executing statistical methods, this handbook will mainly focus on the R programming language, but will also provide some information on Python and Stata.</p>
<p><br></p>
</section>
<section id="section-0-essentials" class="level1">
<h1>Section 0: Essentials</h1>
<p>This section introduces essential concepts in Mathematics and Probability, that are needed for the rest of the modules in the course. If you have a strong basis in Maths/Probability, you may skip these modules, or quickly review them.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Module</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://politicalscience.github.io/section0/1.html">1 Essential Algebra</a></td>
<td>Algebra topics that are essential for the rest of the course, for both methods, and the second module on calculus and linear algebra</td>
</tr>
<tr class="even">
<td><a href="https://politicalscience.github.io/section0/2.html">2 Essential Calculus and Linear Algebra</a></td>
<td>Selected topics in calculus and simple linear algebra that will be referenced throughout the handbook</td>
</tr>
<tr class="odd">
<td><a href="https://politicalscience.github.io/section0/3.html">3 Essential Probability Theory</a></td>
<td>Topics in sets, probabilities, and random variables, that form the basis of statistical theory</td>
</tr>
</tbody>
</table>
<p><br></p>
</section>
<section id="section-1-core-statistical-methods" class="level1">
<h1>Section 1: Core Statistical Methods</h1>
<p>These modules introduce you to the core statistical methods that make up a majority of Political Science research.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Module</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://politicalscience.github.io/section1/4.html">4 Introductory Statistical Inference</a></td>
<td>Introduction to sampling, statistical inference, and hypothesis testing, along with a few simple statistical tests.</td>
</tr>
<tr class="even">
<td>5 Linear Regression Analysis</td>
<td>Analysis of the linear regression model, arguably the most important tool of political science quantitative methods.</td>
</tr>
<tr class="odd">
<td>6 Other Regression Methods</td>
<td>Analysis of other common regression models used in the social sciences, including logistic regression and regression for counts.</td>
</tr>
<tr class="even">
<td>7 Introductory Causal Inference</td>
<td>Discussion of causal inference frameworks, controlled randomised experiments, and a brief introduction into causal inference for observational studies.</td>
</tr>
<tr class="odd">
<td>8 Quasi-Experimental Methods</td>
<td>Analysis of the common causal inference techniques for social sciences, including instrumental variables, regression discontinuity, and differences in differences.</td>
</tr>
</tbody>
</table>
<p><br></p>
</section>
<section id="section-2-formal-mathematical-models" class="level1">
<h1>Section 2: Formal Mathematical Models</h1>
<p>These modules provide an introduction to Game Theory/Formal Theory and mathematical models of decision making and political situations.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Module</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://politicalscience.github.io/section2/9.html">9 Introduction and Static Games</a></td>
<td>Introduction to the idea of game theory, key concepts of games, equilibrium concepts, and static games.</td>
</tr>
<tr class="even">
<td>10 Dynamic Games of Complete Information</td>
<td>Discussion of non-simultaneous games and repeated games, with relevant political examples.</td>
</tr>
<tr class="odd">
<td>11 Bayesian Games</td>
<td>Discussion of dynamic games of incomplete information and perfect bayesian equilibrium.</td>
</tr>
<tr class="even">
<td>12 Modelling and Political Economy</td>
<td>Application of formal mathematical models to common situations in Political Science and Political Economy</td>
</tr>
</tbody>
</table>
<p><br></p>
</section>
<section id="section-3-modern-data-science-methods" class="level1">
<h1>Section 3: Modern Data Science Methods</h1>
<p>Introduction to the advanced prediction methods of machine learning, as well as methods to analyse textual data</p>
<table class="caption-top table">
<caption><br></caption>
<colgroup>
<col style="width: 36%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="header">
<th>Module</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>13 Prediction Methods</td>
<td>Discussion of non-linear and tree-based prediction methods</td>
</tr>
<tr class="even">
<td>14 Classification Methods</td>
<td>Discussion of Naive Bayes and tree-based classifiers</td>
</tr>
<tr class="odd">
<td>15 Model Selection and Regularisation</td>
<td>Discussion of model selection, and regularisation techniques such as Lasso and Ridge</td>
</tr>
<tr class="even">
<td>16 Text Mining</td>
<td>Introduction to the use of machine learning techniques to analyse textual data</td>
</tr>
</tbody>
</table>
</section>
<section id="section-4-advanced-statistical-methods" class="level1">
<h1>Section 4: Advanced Statistical Methods</h1>
<p>Introduction to advanced methods regarding multivariate measurement and methods, as well as time series</p>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Module</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>17 Multivariate Measurement</td>
<td>Discussion of non-model measurement methods such as Principle Components Analysis and Cluster Analysis</td>
</tr>
<tr class="even">
<td>18 Latent Variable Modelling</td>
<td>Modelling of latent variables, such as factor analysis, latent trait and class models</td>
</tr>
<tr class="odd">
<td>19 Structural Equation Models</td>
<td></td>
</tr>
</tbody>
</table>
<p><br></p>
<hr>
</section>
<section id="appendix-topics-in-mathematics" class="level1">
<h1>Appendix: Topics in Mathematics</h1>
<p>This is a supplemental section to the other modules. This section contains most of the mathematics that are needed for the methods utilised in this handbook. If you need a refresher on any of the mathematics involved, this is the place to reference.</p>
<p>While it may be possible to learn mathematics from this section, this isn’t the goal of this section. There is no practice problems, and practice is essential for learning maths. This section mainly is a refresher for concepts relevant to Political Science.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Module</th>
<th>Chapters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1 Additional Topics in Calculus and Linear Algebra</td>
<td>Fills in some of the gaps from Module 1, including integration by parts and substitution, as well as matrix transposition, Kronecker product, and matrix determinants</td>
</tr>
<tr class="even">
<td>3 Vector Spaces and Systems of Equations</td>
<td></td>
</tr>
<tr class="odd">
<td>4 Eigenvalues and Markov Chains</td>
<td></td>
</tr>
<tr class="even">
<td>5 Multivariate Calculus</td>
<td></td>
</tr>
<tr class="odd">
<td>6 Multivariate Optimisation</td>
<td></td>
</tr>
</tbody>
</table>
<p><br></p>
<hr>
</section>
<section id="creator" class="level1">
<h1>About the Author</h1>
<p>This handbook was created by Kevin L. Li</p>
<ul>
<li><a href="https://www.linkedin.com/in/kevinlingfengli/">LinkedIn</a></li>
</ul>
<p>I am a candidate for a MSc in Political Science &amp; Political Economy at the London School of Economics (LSE), focusing on Applied Statistics/Econometrics. Prior to my Masters, I completed a BSc in Politics at King’s College London, focusing on statistical methods and game theory, obtaining a First-Class Honours (US equivalent: Summa Cum Laude) classification. During my Undergraduate Degree, I also took classes in Data Science + Machine Learning and Accounting at the London School of Economics.</p>
<p>I created this page as a helpful guide while studying for my Masters degree. I realised that it would be useful for me, and for my fellow students, to have a collection of Political Science resources in one place.</p>
<p>I do my best to update this handbook: it is a tool not only for my classmates and other political science students, but for me myself. However, as a full-time student with an internship, I may not be able to update this site at a fast enough pace.</p>
<p><br></p>
<hr>
</section>
<section id="resources" class="level1">
<h1>Resources for Learning Statistics and R-Programming</h1>
<ul>
<li><p>For those who need an introduction to statistics, I recommend the <strong>Khan Academy</strong> course on AP Stats for a mathematical introduction: <a href="https://www.khanacademy.org/math/ap-statistics" class="uri">https://www.khanacademy.org/math/ap-statistics</a></p></li>
<li><p>There is also a terrific free textbook on <strong>Statistical learning with applications to R</strong>: <a href="https://www.statlearning.com" class="uri">https://www.statlearning.com</a></p></li>
<li><p><strong>BurkeyAcademy</strong> provides free online econometrics courses and implementations in R: <a href="https://www.burkeyacademy.com/statistics-econometrics" class="uri">https://www.burkeyacademy.com/statistics-econometrics</a></p></li>
<li><p>For more advanced individuals who want to learn more in-depth about statistics, see this excellent <strong>MIT lecture series</strong>: <a href="https://www.youtube.com/playlist?list=PLUl4u3cNGP61ATaGTFcSp7bhogloD2wHP" class="uri">https://www.youtube.com/playlist?list=PLUl4u3cNGP61ATaGTFcSp7bhogloD2wHP</a></p></li>
<li><p>A free resource to learn R with is <strong>CodeAcademy</strong>: <a href="https://www.codecademy.com/enrolled/courses/learn-r" class="uri">https://www.codecademy.com/enrolled/courses/learn-r</a></p></li>
<li><p>For those who have spare cash to spend, there is an excellent R programming course <strong>(Data Analysis with R) offered by IBM on Coursera</strong>, which teaches R and statistics: <a href="https://www.coursera.org/learn/data-analysis-with-r" class="uri">https://www.coursera.org/learn/data-analysis-with-r</a></p></li>
<li><p>I also highly recommend those who can afford it, to attend the <strong>London School of Economic (LSE) Summer School</strong>, which has an excellent course - <strong>ME314 Introduction to Data Science and Machine Learning</strong>. Many of these methods are covered in depth in this course, and the course is run by one of the developers of Quanteda, the main textual-analysis R package.</p></li>
</ul>
<p><br></p>
<hr>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>