<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Linear Algebra</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="2_files/libs/clipboard/clipboard.min.js"></script>
<script src="2_files/libs/quarto-html/quarto.js"></script>
<script src="2_files/libs/quarto-html/popper.min.js"></script>
<script src="2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2_files/libs/quarto-html/anchor.min.js"></script>
<link href="2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: true
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Linear Algebra</h1>
            <p class="subtitle lead">Essential Mathematics</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#vector-spaces" id="toc-vector-spaces" class="nav-link active" data-scroll-target="#vector-spaces"><strong>Vector Spaces</strong></a>
  <ul class="collapse">
  <li><a href="#linear-mapping" id="toc-linear-mapping" class="nav-link" data-scroll-target="#linear-mapping">Linear Mapping</a></li>
  <li><a href="#vectors-and-vector-spaces" id="toc-vectors-and-vector-spaces" class="nav-link" data-scroll-target="#vectors-and-vector-spaces">Vectors and Vector Spaces</a></li>
  <li><a href="#linear-combination" id="toc-linear-combination" class="nav-link" data-scroll-target="#linear-combination">Linear Combination</a></li>
  <li><a href="#linear-independence" id="toc-linear-independence" class="nav-link" data-scroll-target="#linear-independence">Linear Independence</a></li>
  <li><a href="#spanning-vectors-and-dimension" id="toc-spanning-vectors-and-dimension" class="nav-link" data-scroll-target="#spanning-vectors-and-dimension">Spanning Vectors and Dimension</a></li>
  <li><a href="#matrix-rank" id="toc-matrix-rank" class="nav-link" data-scroll-target="#matrix-rank">Matrix Rank</a></li>
  <li><a href="#quadratic-forms" id="toc-quadratic-forms" class="nav-link" data-scroll-target="#quadratic-forms">Quadratic Forms</a></li>
  </ul></li>
  <li><a href="#solving-systems-of-equations" id="toc-solving-systems-of-equations" class="nav-link" data-scroll-target="#solving-systems-of-equations"><strong>Solving Systems of Equations</strong></a>
  <ul class="collapse">
  <li><a href="#matrices-and-systems-of-equations" id="toc-matrices-and-systems-of-equations" class="nav-link" data-scroll-target="#matrices-and-systems-of-equations">Matrices and Systems of Equations</a></li>
  <li><a href="#matrix-rank-and-systems-of-equations" id="toc-matrix-rank-and-systems-of-equations" class="nav-link" data-scroll-target="#matrix-rank-and-systems-of-equations">Matrix Rank and Systems of Equations</a></li>
  <li><a href="#matrix-inversion" id="toc-matrix-inversion" class="nav-link" data-scroll-target="#matrix-inversion">Matrix Inversion</a></li>
  <li><a href="#cramers-rule" id="toc-cramers-rule" class="nav-link" data-scroll-target="#cramers-rule">Cramerâ€™s Rule</a></li>
  </ul></li>
  <li><a href="#eigenvalues-and-eigenvectors" id="toc-eigenvalues-and-eigenvectors" class="nav-link" data-scroll-target="#eigenvalues-and-eigenvectors"><strong>Eigenvalues and Eigenvectors</strong></a>
  <ul class="collapse">
  <li><a href="#definitions" id="toc-definitions" class="nav-link" data-scroll-target="#definitions">Definitions</a></li>
  <li><a href="#computing-eigenvalues" id="toc-computing-eigenvalues" class="nav-link" data-scroll-target="#computing-eigenvalues">Computing Eigenvalues</a></li>
  <li><a href="#calculating-eigenvectors" id="toc-calculating-eigenvectors" class="nav-link" data-scroll-target="#calculating-eigenvectors">Calculating Eigenvectors</a></li>
  <li><a href="#eigenvector-decomposition" id="toc-eigenvector-decomposition" class="nav-link" data-scroll-target="#eigenvector-decomposition">Eigenvector Decomposition</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Use the sidebar for easy navigation.</p>
<hr>
<section id="vector-spaces" class="level1">
<h1><strong>Vector Spaces</strong></h1>
<section id="linear-mapping" class="level3">
<h3 class="anchored" data-anchor-id="linear-mapping">Linear Mapping</h3>
<p>A mapping is any rule that maps elements from one set to another. A function <span class="math inline">f</span> is a mapping <span class="math inline">f: A \rightarrow B</span>.</p>
<p>A linear mapping is a mapping that is linear, which must meet the following properties:</p>
<ul>
<li><span class="math inline">f(a+b) = f(a) + f(b)</span></li>
<li><span class="math inline">f(ca) = c f(a)</span></li>
</ul>
<p>We can represent linear mappings for finite sets by matrices. Let us say <span class="math inline">\mathbf X_{n \times m}</span> is a matrix, and <span class="math inline">\mathbf y_{m}</span> is a vector. Let us find their product:</p>
<p><span class="math display">
\mathbf {Xy} = \mathbf z_m
</span></p>
<p>What this is saying is take the vector <span class="math inline">\mathbf y</span>, and operate on it using the matrix <span class="math inline">\mathbf X</span>, to produce a new vector <span class="math inline">\mathbf z</span>. Here, the matrix <span class="math inline">\mathbf X</span> is an operator that maps <span class="math inline">\mathbf y \rightarrow \mathbf z</span>.</p>
<p><br></p>
</section>
<section id="vectors-and-vector-spaces" class="level3">
<h3 class="anchored" data-anchor-id="vectors-and-vector-spaces">Vectors and Vector Spaces</h3>
<p>Vectors have a norm (which is also called the inner product):</p>
<p><span class="math display">
||\mathbf a|| = \sqrt{\mathbf a \cdot \mathbf a} = \sqrt{a_1^2 + a_2^2+\dots+a_n^2}
</span></p>
<p>Vector spaces are any collection of vectors that have a norm, that have some common properties.</p>
<p>Vectors are important because our data is represented in vectors.</p>
<p><br></p>
</section>
<section id="linear-combination" class="level3">
<h3 class="anchored" data-anchor-id="linear-combination">Linear Combination</h3>
<p>A linear combination is a combination of vectors that is linear (i.e.&nbsp;vectors can be added, and scalar multiplied). For example, this is a linear combination:</p>
<p><span class="math display">
t \mathbf x + (1-t) \mathbf y
</span></p>
<p>Linear combinations either represents lines (in <span class="math inline">\mathbb R^2</span>), planes (in <span class="math inline">\mathbb R^3</span>), and hyperplanes (a plane of one less dimensions than the space) in higher dimensions.</p>
<p><br></p>
</section>
<section id="linear-independence" class="level3">
<h3 class="anchored" data-anchor-id="linear-independence">Linear Independence</h3>
<p>Start off with a linear combination:</p>
<p><span class="math display">
a_1 \mathbf x_1 + a_2 \mathbf x_2+\dots + a_n \mathbf x_n
</span></p>
<p>This set of vectors <span class="math inline">(\mathbf x_1, \dots, \mathbf x_n)</span> is independent if you cannot get one vector <span class="math inline">\mathbf x_j \in \{ \mathbf x_1, \dots, \mathbf x_n \}</span> equal to a combination or multiple of the other vectors.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of Linear Independence
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let us say we have these two vectors:</p>
<p><span class="math display">
\begin{pmatrix} 1 \\ 2 \end{pmatrix}, \begin{pmatrix} 2 \\ 1 \end{pmatrix}
</span></p>
<p>Are these linearly independent? That means I cannot use a linear transformation to go from one to another.</p>
<p>No, there is no constant you can multiply to get from vector 1 to vector 2, and there are no other vectors to add/subtract to to go from one to another.</p>
<p>Now consider these two vectors:</p>
<p><span class="math display">
\begin{pmatrix} 1 \\ 2 \end{pmatrix}, \begin{pmatrix} 2 \\ 4 \end{pmatrix}
</span></p>
<p>These are not independent - you can multiply the first vector by a scalar of 2 to get the second vector.</p>
</div>
</div>
</div>
<p>This can be complicated to see in higher dimensions (since it is hard to consider how multiple vectors can be combined to match another). There, we use the matrix rank (see below).</p>
<p><br></p>
</section>
<section id="spanning-vectors-and-dimension" class="level3">
<h3 class="anchored" data-anchor-id="spanning-vectors-and-dimension">Spanning Vectors and Dimension</h3>
<p>A collection of spanning vectors spans some space, if you can write any vector in that space, as a linear combination of the spanning vectors.</p>
<p>For example, take vector <span class="math inline">\mathbf e_1 = (1 \ 0)</span> and <span class="math inline">\mathbf e_2 = (0 \ 1)</span>. These vectors span some space including <span class="math inline">\mathbf z</span>, if vector <span class="math inline">\mathbf z</span> can be written as:</p>
<p><span class="math display">
\mathbf z = a \mathbf e_1 + b \mathbf e_2, \quad \text{e.x.} \quad \mathbf z = (a \ b)
</span></p>
<ul>
<li>In fact, <span class="math inline">\mathbf e_1</span> and <span class="math inline">\mathbf e_2</span> span the set of all 2-dimensional vectors.</li>
</ul>
<p>This allows us to write vectors in terms of the core vectors, and to understand the dimension of the space.</p>
<p>The <strong>dimension</strong> of the space is the smallest number of linearly independent vectors that span the space.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of Dimensionality
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Take these two vectors:</p>
<p><span class="math display">
\begin{pmatrix} 1 \\ 0 \end{pmatrix}, \begin{pmatrix} 0 \\ 1 \end{pmatrix}
</span></p>
<p>These are linearly independent - no factor multipled can get the other vector. Thus, this is 2 dimensional space</p>
<p>Now, let us add a third vector.</p>
<p><span class="math display">
\begin{pmatrix} 1 \\ 0 \end{pmatrix}, \begin{pmatrix} 0 \\ 1 \end{pmatrix}, \begin{pmatrix} 3 \\ 2 \end{pmatrix}
</span></p>
<p>Is the third vector linearly independent? No.&nbsp;We can write the third vector with a combination of the other two:</p>
<p><span class="math display">
\begin{pmatrix} 3 \\ 2 \end{pmatrix} = 3 \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 2 \begin{pmatrix} 0 \\ 1 \end{pmatrix}
</span></p>
<p>Thus, the third vector is in the space spanned by the first 2 vectors. The first two vectors spans this space, and thus, it is 2 dimensional space.</p>
</div>
</div>
</div>
<p>Generally, the dimensionality of the space matches the number of vectors that span the space (so a 2 dimensional space is often spanned by 2 vectors, 3 spanned by 3, etc.).</p>
<p>Note: Dimensionality of a vector space is not always the same as the dimensionality of the vectors.</p>
<p><br></p>
</section>
<section id="matrix-rank" class="level3">
<h3 class="anchored" data-anchor-id="matrix-rank">Matrix Rank</h3>
<p>As we discussed before, it can be difficult to find if vectors are linearly independent in higher dimensions.</p>
<p>We can stack the row vectors into a matrix (we can also do them in columns):</p>
<p><span class="math display">
\begin{pmatrix} \mathbf x_1 \\ \mathbf x_2 \\ \mathbf x_3 \end{pmatrix} =
\begin{pmatrix} x_{11} &amp; x_{12} &amp; x_{13} \\
x_{21} &amp; x_{22} &amp; x_{23} \\
x_{31} &amp; x_{32} &amp; x_{33} \end{pmatrix}
</span></p>
<p>The <strong>Rank</strong> of a matrix is the number of linearly independent rows/columns in a matrix.</p>
<p>If the Rank is equal to the total number of rows/columns (all rows/columns are linearly independent), the matrix has <strong>full rank</strong>.</p>
<ul>
<li>A matrix with full rank is non-singular, and thus, can be inverted, and has a non-zero determinant.</li>
</ul>
<p>Thus, if we find the determinant of the matrix, if it is 0, the vectors are <u>not</u> linearly independent, and if it is not0 , they are linearly independent.</p>
<p>We can also know a matrix is not full rank, if the space of the dimension is less than the number of vectors (as explained above).</p>
<p><br></p>
</section>
<section id="quadratic-forms" class="level3">
<h3 class="anchored" data-anchor-id="quadratic-forms">Quadratic Forms</h3>
<p>A quadratic form takes the following form:</p>
<p><span class="math display">
\mathbf x^T \mathbf A \mathbf x
</span></p>
<ul>
<li>Where matrix <span class="math inline">\mathbf A</span> is a square matrix.</li>
</ul>
<p>If <span class="math inline">\mathbf x^T \mathbf A \mathbf x &gt; 0</span> for all values, then the matrix is positive definite. If <span class="math inline">\mathbf x^T \mathbf A \mathbf x &lt; 0</span>, then negative definite. If <span class="math inline">\mathbf x^T \mathbf A \mathbf x â‰¤ 0</span> it is positive semi-definite.</p>
<p>This will be useful for optimisation.</p>
<p><br></p>
<p><br></p>
<hr>
</section>
</section>
<section id="solving-systems-of-equations" class="level1">
<h1><strong>Solving Systems of Equations</strong></h1>
<section id="matrices-and-systems-of-equations" class="level3">
<h3 class="anchored" data-anchor-id="matrices-and-systems-of-equations">Matrices and Systems of Equations</h3>
<p>You can write any system of linear equations as a matrix times a vector. Let us take this set of equations:</p>
<p><span class="math display">
\begin{cases}
a_{11}x_1 + a_{12} x_2 + a_{13} x_3 = y_1 \\
a_{21}x_1 + a_{22}x_2 + a_{23}x_3 = y_2 \\
a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = y_3
\end{cases}
</span></p>
<p>We can write this system of equations as follows:</p>
<p><span class="math display">
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13} \\
a_{21} &amp; a_{22} &amp; a_{23} \\
a_{31} &amp; a_{32} &amp; a_{33}
\end{pmatrix} \begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix}
= \begin{pmatrix} y_1 \\ y_2 \\ y_3 \end{pmatrix}
</span></p>
<p>Or even simpler, we can represent it as:</p>
<p><span class="math display">
\mathbf A\mathbf x = \mathbf y
</span></p>
<p>A unique solution exists when you have the same amount of equations as unknowns, and the equations are non-contradictory.</p>
<ul>
<li>Overdetermined systems are when there are more equations than unknowns, which might contradict each other.</li>
<li>Underdetermined systems are when there are not enough equations compared to unknowns, so we cannot solve it.</li>
</ul>
<p><br></p>
</section>
<section id="matrix-rank-and-systems-of-equations" class="level3">
<h3 class="anchored" data-anchor-id="matrix-rank-and-systems-of-equations">Matrix Rank and Systems of Equations</h3>
<p>Take this system of linear equations:</p>
<p><span class="math display">
\begin{cases}
x+y=1 \\
2x + 2y = 2
\end{cases}
</span></p>
<p>We can see that the two equations are a common factor of each other. Or in other words, these two vectors are non-linearly independent.</p>
<p>We know when solving for these equations, we cannot actually solve for a unique solution.</p>
<p>We know if a matrix is full rank, then all rows/columns are linearly independent.</p>
<p><br></p>
</section>
<section id="matrix-inversion" class="level3">
<h3 class="anchored" data-anchor-id="matrix-inversion">Matrix Inversion</h3>
<p>Matrix inversion is a way to solve a system of equations. Take this system of equations:</p>
<p><span class="math display">
\mathbf{Ax} = \mathbf y
</span></p>
<p>You can solve for <span class="math inline">\mathbb x</span> by inverting matrix <span class="math inline">\mathbf A</span> (assuming matrix a is full rank):</p>
<p><span class="math display">
\begin{split}
\mathbf{Ax} &amp; = \mathbf y \\
\mathbf{A}^{-1}\mathbf{Ax} &amp; = \mathbf A^{-1}\mathbf y \\
\mathbf x &amp;= \mathbf A^{-1}\mathbf y
\end{split}
</span></p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of Matrix Inversion
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Take this system of equations:</p>
<p><span class="math display">
\begin{cases}
3x - 7y = -11 \\
5x + 10y = 25
\end{cases}
</span></p>
<p>We can write this in linear algebra:</p>
<p><span class="math display">
\begin{pmatrix}
3 &amp; -7 \\
5 &amp; 10
\end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} =
\begin{pmatrix} -11 \\ 25 \end{pmatrix}
</span></p>
<p>Now, let us find the inverse of the first matrix:</p>
<p><span class="math display">
\mathbf A^{-1} = \frac{1}{|\mathbf A|}\mathbf C^T
</span></p>
<p>We know the determinant <span class="math inline">|\mathbf A| = 3(10) - (-7)(5) = 65</span>.</p>
<p>Now, let us find the cofactor matrix:</p>
<ul>
<li><span class="math inline">c_{11} = (-1)^{1+1}\times 10 = 10</span></li>
<li><span class="math inline">c_{12} = (-1)^{1+2} \times 5 = -5</span></li>
<li><span class="math inline">c_{21} = (-1)^{2+1} \times -7 = 7</span></li>
<li><span class="math inline">c_{22} = (-1)^{2+2} \times 3 = 3</span></li>
</ul>
<p>Thus, the cofactor matrix transposed should be:</p>
<p><span class="math display">
\mathbf C^T = \begin{pmatrix} 10 &amp; -5 \\ 7 &amp; 3 \end{pmatrix}^T = \begin{pmatrix} 10 &amp; 7 \\ -5 &amp; 3 \end{pmatrix}
</span></p>
<p>Thus, the inverse of matrix <span class="math inline">\mathbf{A}</span> should be:</p>
<p><span class="math display">
\mathbf A^{-1} = \frac{1}{65} \begin{pmatrix} 10 &amp; 7 \\ -5 &amp; 3 \end{pmatrix} = \begin{pmatrix} \frac{2}{13} &amp; \frac{7}{65} \\ -\frac{1}{13} &amp; \frac{3}{65} \end{pmatrix}
</span></p>
<p>We know the solution should be:</p>
<p><span class="math display">
\begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix} \frac{2}{13} &amp; \frac{7}{65} \\ -\frac{1}{13} &amp; \frac{3}{65} \end{pmatrix} \begin{pmatrix} -11 \\ 25 \end{pmatrix}
</span></p>
<p>Thus, doing matrix multiplication to obtain <span class="math inline">x</span> and <span class="math inline">y</span>:</p>
<ul>
<li><span class="math inline">x =\frac{2}{13}(-11) + \frac{7}{65}(25) = -\frac{22}{13} + \frac{35}{13} = \frac{13}{13}=1</span></li>
<li><span class="math inline">y=-\frac{1}{13}(-11) + \frac{3}{65}(25) = \frac{11}{13}+ \frac{15}{13} = \frac{26}{13} = 2</span></li>
</ul>
<p>The solution to this system of equations is: <span class="math inline">(1, 2)</span>.</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="cramers-rule" class="level3">
<h3 class="anchored" data-anchor-id="cramers-rule">Cramerâ€™s Rule</h3>
<p>Cramerâ€™s rule is another rule to solve equations, only for square matrices. It is not super commonly used.</p>
<p>Given the system of equations:</p>
<p><span class="math display">
\mathbf{Ax} = \mathbf y
</span></p>
<p>The element <span class="math inline">x_i</span> is defined as:</p>
<p><span class="math display">
x_i = \frac{|\mathbf B_i|}{\mathbf A}
</span></p>
<p>Where <span class="math inline">\mathbf B_i</span> is a matrix obtained by taking the matrix <span class="math inline">\mathbf A</span>, and replacing the <span class="math inline">i</span>th column with the column vector <span class="math inline">\mathbf y</span>.</p>
<p><br></p>
<p><br></p>
<hr>
</section>
</section>
<section id="eigenvalues-and-eigenvectors" class="level1">
<h1><strong>Eigenvalues and Eigenvectors</strong></h1>
<section id="definitions" class="level3">
<h3 class="anchored" data-anchor-id="definitions">Definitions</h3>
<p>A matrix, as we discussed, can act as an operator that maps some vector to another <span class="math inline">\mathbf A : \mathbf x \rightarrow \mathbf y</span>.</p>
<p>Geometrically, vector <span class="math inline">\mathbf x</span> points in some dimensional space. Then the matrix <span class="math inline">\mathbf A</span> comes along, and transforms it into a different vector <span class="math inline">\mathbf x</span>, which might flip the direction, or rotate, or change its norm, etc. Sometimes, <span class="math inline">\mathbf y</span> will stay in the same direction or opposite direction (along the same line) as the original, even after the operator.</p>
<p>Basically, an eigenvector of matrix <span class="math inline">\mathbf A</span> is a vector <span class="math inline">\mathbf x</span>, that does not change its direction (stays on the same line) when you apply the operator <span class="math inline">\mathbf A</span> to get vector <span class="math inline">\lambda \mathbf x</span>. Mathematically:</p>
<p><span class="math display">
\mathbf{Ax} = \lambda \mathbf x
</span></p>
<p>The <span class="math inline">\lambda</span> is an eigenvalue that corresponds to the eigenvector.</p>
<p><br></p>
</section>
<section id="computing-eigenvalues" class="level3">
<h3 class="anchored" data-anchor-id="computing-eigenvalues">Computing Eigenvalues</h3>
<p>Let us start with the eigenvector formula:</p>
<p><span class="math display">
\mathbf{Ax} = \lambda \mathbf x
</span></p>
<p>We can multiply the right side by the identity matrix (which does not change the result):</p>
<p><span class="math display">
\mathbf{Ax} = \lambda \mathbf {Ix}
</span></p>
<p>Now, let us move everything to one side, and simplify:</p>
<p><span class="math display">
\begin{split}
\mathbf{Ax} - \lambda \mathbf {Ix} &amp; = 0 \\
(\mathbf A - \lambda \mathbf I) \mathbf x &amp; = 0
\end{split}
</span></p>
<p><span class="math inline">(\mathbf A - \lambda \mathbf I)</span> is an singular matrix, meaning determinant <span class="math inline">|(\mathbf A - \lambda \mathbf I)| = 0</span>. All values of <span class="math inline">\lambda</span> that solve this determinant equation will be eigenvalues of the matrix.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of Solving for Eigenvalues
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We know <span class="math inline">|(\mathbf A - \lambda \mathbf I)| = 0</span>. Let us say:</p>
<p><span class="math display">
\mathbf A = \begin{pmatrix} 2 &amp; 1 \\ 3 &amp; 4 \end{pmatrix}, \quad \lambda \mathbf I \begin{pmatrix} \lambda &amp; 0 \\ 0 &amp; \lambda \end{pmatrix}
</span></p>
<p>Thus:</p>
<p><span class="math display">
\mathbf A - \lambda \mathbf I = \begin{pmatrix} 2 - \lambda &amp; 1 \\ 3 &amp; 4 - \lambda \end{pmatrix}
</span></p>
<p>We know the determinant should equal 0. We can solve for <span class="math inline">\lambda</span>:</p>
<p><span class="math display">
\begin{split}
0 &amp; = |(\mathbf A - \lambda \mathbf I)| \\
0 &amp; = (2-\lambda)(4-\lambda) - 1(3) \\
0 &amp; = 8-2\lambda - 4 \lambda +\lambda^2 - 4 \\
0 &amp; = \lambda^2 - 6\lambda +4 \\
\end{split}
</span></p>
<p>Let us use the quadratic formula:</p>
<p><span class="math display">
\begin{split}
\lambda &amp; = \frac{-b Â± \sqrt{b^2 - 4ac}}{2a} \\
\lambda &amp; = \frac{6 Â± \sqrt{36 - 4(1)(4)}}{2(1)} \\
\lambda &amp; = \frac{6 Â± \sqrt{20}}{2} \\
\lambda &amp; = 3 Â± \frac{\sqrt{20}}{2} \\
\lambda &amp; = 3 Â± \frac{2 \sqrt{5}}{2} \\
\lambda &amp; = 3 Â± \sqrt{5}
\end{split}
</span></p>
<p>Thus, we have found our eigenvalues.</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="calculating-eigenvectors" class="level3">
<h3 class="anchored" data-anchor-id="calculating-eigenvectors">Calculating Eigenvectors</h3>
<p>Let us say we have the matrix <span class="math inline">\mathbf{A}</span>:</p>
<p><span class="math display">
\mathbf A = \begin{pmatrix} 2 &amp; 3 \\ 2 &amp; 1 \end{pmatrix}
</span></p>
<p>First, you need to calculate the eigenvalues <span class="math inline">\lambda</span> (as shown in the previous section).</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of Calculating Eigenvalues
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We know <span class="math inline">|(\mathbf A - \lambda \mathbf I)| = 0</span>.</p>
<p><span class="math display">
\mathbf A - \lambda \mathbf I = \begin{pmatrix} 2 - \lambda &amp; 3 \\ 2 &amp; 1 - \lambda \end{pmatrix}
</span></p>
<p>Now solve <span class="math inline">|(\mathbf A - \lambda \mathbf I)| = 0</span>.</p>
<p><span class="math display">
\begin{split}
0 &amp; = |(\mathbf A - \lambda \mathbf I)| \\
0 &amp; = (2 - \lambda)(1- \lambda) - 2(3) \\
0 &amp; = 2 -2 \lambda - \lambda + \lambda^2 - 6 \\
0 &amp; = \lambda ^2 - 3\lambda - 4 \\
0 &amp; = (\lambda - 4)(\lambda + 1) \\
\lambda &amp; = 4, -1
\end{split}
</span></p>
</div>
</div>
</div>
<p>For every eigenvalue, you will have an eigenvector that makes the eigenvector equation <span class="math inline">\mathbf{Ax} = \lambda \mathbf x</span> true. From above:</p>
<p><span class="math display">
\begin{split}
&amp; \mathbf{Ax} = 4 \mathbf x \\
&amp; \mathbf{Ax} = -1 \mathbf x
\end{split}
</span></p>
<p>Remember, <span class="math inline">\mathbf x</span> is a vector here of 2 elements, <span class="math inline">x_1, x_2</span> - but we only have one equation for each eigenvalue pair. This means there will be one solution without a unique solution.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Eigenvalues and Non-Unique Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>It might seem simple to just solve for our <span class="math inline">\mathbf x</span> with two unknowns <span class="math inline">x_1, x_2</span>.</p>
<p>But the issue is - our equations are not linearly independent, so we do not have enough information to solve for a unique solution for one.</p>
<p>This is actually okay - why? Well, take a look at these potential eigenvectors:</p>
<p><span class="math display">
\begin{pmatrix} 1 \\ 0 \end{pmatrix}, \begin{pmatrix} 2 \\ 0 \end{pmatrix}, \begin{pmatrix} 3 \\ 0 \end{pmatrix}
</span></p>
<p>These are different vectors - but they are all eigenvectors. This is because of the equation <span class="math inline">\mathbf{Ax} = \lambda \mathbf x</span> - if both sides have vector <span class="math inline">(1 \ 0)</span> multiplied by a constant (like the 2nd and 3rd vectors), the equation is still equal.</p>
<p>Thus, eigenvectors are not defined uniquely - only up to a singular multiplicative constant.</p>
</div>
</div>
</div>
<p>What we typically do is define <span class="math inline">x_1 = 1</span> (there are some cases where this does not work). Using this, we can solve for the answer.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of Calculating Eigenvectors
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let us continue the same example from before.</p>
<p><span class="math display">
\mathbf A = \begin{pmatrix} 2 &amp; 3 \\ 2 &amp; 1 \end{pmatrix}, \quad \lambda = 4, -1, \quad \mathbf x = \begin{pmatrix} 1 \\ c \end{pmatrix}
</span></p>
<p>Let us solve for the eigenvalue of <span class="math inline">\lambda = 4</span>.</p>
<p><span class="math display">
\begin{split}
\mathbf{Ax} &amp; = 4 \mathbf x \\
\begin{pmatrix} 2 &amp; 3 \\ 2 &amp; 1 \end{pmatrix}\begin{pmatrix} 1 \\ c \end{pmatrix} &amp; = 4\begin{pmatrix} 1 \\ c \end{pmatrix} \\
\begin{pmatrix} 2+3c \\ 2+c \end{pmatrix} &amp; = \begin{pmatrix} 4 \\ 4c \end{pmatrix}
\end{split}
</span></p>
<p>That gives us two equations:</p>
<p><span class="math display">
\begin{split}
&amp; 2 + 3c = 4 \\
&amp; 2 + c = 4c
\end{split}
</span></p>
<p>The answer is <span class="math inline">c = \frac{2}{3}</span> (both answers give us the equation).</p>
<p>Thus, the eigenvector with <span class="math inline">\lambda = 4</span> is:</p>
<p><span class="math display">
\mathbf x = \begin{pmatrix} 1 \\ \frac{2}{3} \end{pmatrix}
</span></p>
<p>We can do the same for <span class="math inline">\lambda = -1</span>, and we will get eigenvector:</p>
<p><span class="math display">
\mathbf x = \begin{pmatrix} 1 \\ -1 \end{pmatrix}
</span></p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="eigenvector-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="eigenvector-decomposition">Eigenvector Decomposition</h3>
<p>Matrix decomposition is to take a matrix <span class="math inline">\mathbf A</span>, and decompose it into other matrices, that when multiplied together, get the original matrix.</p>
<p>If matrix <span class="math inline">\mathbf A</span> has unique eigenvalues, you can write:</p>
<p><span class="math display">
\mathbf A = \mathbf {QDQ}^{-1}
</span></p>
<p>Where <span class="math inline">\mathbf Q</span> is made up of eigenvectors of matrix <span class="math inline">\mathbf A</span>, and <span class="math inline">\mathbf D</span> is a diagonal matrix with the eigenvalues <span class="math inline">\lambda</span> on the diagonal:</p>
<p><span class="math display">
\mathbf D = \begin{pmatrix} \lambda_1 &amp; 0 \\ 0 &amp; \lambda_2 \end{pmatrix}, \quad
\mathbf Q = \begin{pmatrix} \mathbf x_1 &amp; \mathbf x_2\end{pmatrix}
</span></p>
<p>Eigenvectors decomposition has a few uses:</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Taking the Power of Matrices
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let us say you want to find <span class="math inline">\mathbf A^z</span>. We can use matrix decomposition for this:</p>
<p><span class="math display">
\mathbf A^z = {QDQ}^{-1}{QDQ}^{-1}{QDQ}^{-1}\dots
</span></p>
<p>Notice how the <span class="math inline">\mathbf{Q}^{-1} \mathbf Q</span> occurs quite frequently, and we know by properties of inverses, that <span class="math inline">\mathbf{Q}^{-1} \mathbf Q = \mathbf I</span>, and multiplying by <span class="math inline">\mathbf I</span> does nothing.</p>
<p>Thus, we can rewrite the formula above as:</p>
<p><span class="math display">
\mathbf A^z = \mathbf{QD}^z\mathbf Q^{-1}
</span></p>
<p>This is much simpler than calculating <span class="math inline">\mathbf A^z</span>, since taking diagonal matrix to a power is defined as:</p>
<p><span class="math display">
\mathbf D^z = \begin{pmatrix} \lambda_1^z &amp; 0 \\ 0 &amp; \lambda_2^z\end{pmatrix}
</span></p>
<p>Which is much easier to do.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Finding Determinants
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let us say you want to find the determinant of <span class="math inline">\mathbf A</span>. The following is true:</p>
<p><span class="math display">
\begin{split}
\det (\mathbf A) &amp; = \det(\mathbf{QD}^z\mathbf Q^{-1}) \\
&amp; = \det (\mathbf Q) \det (\mathbf D) \det (\mathbf Q^{-1}) \\
&amp; = \det (\mathbf Q) \det (\mathbf D) \frac{1}{\det (\mathbf Q)} \\
&amp; = \det (\mathbf D)
\end{split}
</span></p>
<p>Since <span class="math inline">\mathbf D</span> is diagonal, the determinant of a diagonal matrix is just the product of the diagonal elements. Thus:</p>
<p><span class="math display">
\det (\mathbf A) = \prod_i \lambda_i
</span></p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Principle Component Analysis
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Principle Component Analysis (PCA) is used when matrix <span class="math inline">\mathbf A</span> is symmetric, positive semi-definite.</p>
<ul>
<li>This means the eigenvectors are orthogonal (perpendicular) to each other.</li>
<li>This means eigenvalues will always be real and non-negative.</li>
</ul>
<p>PCA is done on the covariance matrix, which is symmetric and positive semi-definite.</p>
<p>It is a data reduction technique commonly used in statistics and data science. We will discuss this in the multivariate statistics section.</p>
<ul>
<li>The eigenvectors of the covariance matrix form the principle components of thee system.</li>
<li>The eigenvalues tell us how much of the variance each component explains (more important principle components have higher eigenvalues).</li>
</ul>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>